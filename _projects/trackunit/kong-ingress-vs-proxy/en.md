---
title: "Trackunit: Kong as Ingress Controller and API Gateway"
categories: [trackunit, kubernetes]
tags: [kong, ingress, api-gateway, configuration, final]
lang: en
locale: en
nav_order: 45
ref: kong-ingress-vs-proxy
---

##### Ingress Controller

The **Kong Ingress Controller** runs as a separate container in the same Deployment as **Kong Proxy** and reads Kubernetes resources such as `Ingress`.  
Based on these resources, the required configuration is created inside **Kong** through the Kong Admin API.  
The Ingress Controller does *not* process traffic; it only configures the gateway.

`IngressClass: kong` is created automatically by the Helm chart when `ingressController.enabled: true`.

```yaml
# values.ingress-tls.yaml

ingressController:
  enabled: true
  ingressClass: kong
...
```

##### Kong Proxy

**Kong Proxy** is the actual gateway and handles incoming traffic.  
It listens on port `443` (via the LoadBalancer service) and matches host and path based on the configuration generated by the Kong Ingress Controller from `ingress-graphql.yaml`.

```yaml
# values.ingress-tls.yaml

...
env:
  database: "off"
proxy:
  type: LoadBalancer
  http:
    enabled: false
  tls:
    enabled: true
    servicePort: 443
    containerPort: 8443
secretVolumes:
  - kong-ingress-tls
```

##### The Ingress Resource

The Ingress resource defines host, path and TLS settings and refers to `IngressClass: kong`.  
It is only a declaration â€” the **Kong Ingress Controller** converts it into actual runtime configuration in **Kong**.

```yaml
# ingress-graphql.yaml

apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: ingress-graphql
  namespace: api-gateway
  annotations:
    konghq.com/strip-path: "false"
    konghq.com/protocols: "https"
spec:
  ingressClassName: kong
  tls:
  - hosts:
      - graphql.local
    secretName: kong-ingress-tls
  rules:
  - host: graphql.local
    http:
      paths:
      - path: /graphql
        pathType: Prefix
        backend:
          service:
            name: oauth2-proxy
            port:
              number: 4180
```

##### TLS (self-signed certificate)

For local development, a self-signed certificate named `kong-ingress-tls` is used.  
It is stored as a Kubernetes Secret and referenced from the Ingress resource.  
The Ingress Controller registers the certificate and creates the corresponding TLS configuration in **Kong**, after which **Kong Proxy** presents the certificate at runtime.